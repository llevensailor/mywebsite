---
title: "College Statistics"
author: 
- name: Leah Levensailor
  affiliation: Smith College
date: "`r format(Sys.Date(), '%B %e, %Y')`"
editor: 
  mode: source
output: 
  html_document:
    fig_width: 7
    fig_height: 6
    fig_caption: true
    df_print: paged
    code_folding: show
execute:
  echo: false
knitr:
  opts_chunk: 
    message: false
    warning: false  
---

```{r setup, include=FALSE}
#| echo: false 

library(tidyverse)
library(rscorecard)

sc_key("8zSatmutJajRDsdGV4Kp5Uaw3mPTqVwo1mFE0umT")
```

```{r import}
#| echo: false
scorecard <- sc_init() |>
  sc_year(2021) |>                 #Note how we are looking at only 2021 data here!
  sc_filter(stabbr == "MA") |>     #Note how we are looking at only Massachusetts data here!
  #The line below shows variable selection (there are lots of variables)

  sc_select(unitid, instnm, city, highdeg, control, ugds, adm_rate, costt4_a, costt4_p, pcip27, pctfloan, admcon7, wdraw_orig_yr2_rt, cdr3, opeid, stabbr, zip, accredagency, insturl, main, numbranch, preddeg, st_fips,region,locale,latitude,longitude) |>

  sc_get()

```

```{r recode}
#| echo: false
#  Here's an example of how to recode the control variable

# We are renaming the column control_text from control
scorecard$control_text <-
  #The recode function does the work. It calls 1 "Public", 2 " Private nonprofit",etc. 
  recode(
    scorecard$control, 
    "1" = "Public", 
    "2" = "Private nonprofit", 
    "3" = "Private for-profit",
    .default = NA_character_
  )

# test code
scorecard$region_text <-
  recode(
    scorecard$region, 
    "0" = "U.S. Service Schools",
    "1" = "New England (CT, ME, MA, NH, RI, VT)
", 
    "2" = "Mid East (DE, DC, MD, NJ, NY, PA)
", 
    "3" = "Great Lakes (IL, IN, MI, OH, WI)
",
    "4" = "Plains (IA, KS, MN, MO, NE, ND, SD)
",
    "5" = "Southeast (AL, AR, FL, GA, KY, LA, MS, NC, SC, TN, VA, WV)
", 
    "6" = "Southwest (AZ, NM, OK, TX)
",
    "7" = "Rocky Mountains (CO, ID, MT, UT, WY)
",
    "8" = "Far West (AK, CA, HI, NV, OR, WA)
",
    "9" = "Outlying Areas (AS, FM, GU, MH, MP, PR, PW, VI)
",
    .default = NA_character_
  )
scorecard$deg_text <- recode(
  scorecard$highdeg,
  "0" = "Non-degree-granting
",
  "1" = "Certificate degree

",
  "2" = "Associate degree
", 
"3" = "Bachelor's degree
",
"4" = "Graduate degree
",
.default = NA_character_
)


scorecard$region_text <-
  #The recode function does the work. It calls 1 "Public", 2 " Private nonprofit",etc. 
  recode(
    scorecard$region, 
    "1" = "New England (CT, ME, MA, NH, RI, VT)", 
    "2" = "Mid East (DE, DC, MD, NJ, NY, PA)", 
    "3" = "Great Lakes (IL, IN, MI, OH, WI)",
    "4" = "Plains (IA, KS, MN, MO, NE, ND, SD)",
    "5" = "Southeast (AL, AR, FL, GA, KY, LA, MS, NC, SC, TN, VA, WV)",
    "6" = "Southwest (AZ, NM, OK, TX)",
    "7" = "Rocky Mountains (CO, ID, MT, UT, WY)",
    "8" = "Far West (AK, CA, HI, NV, OR, WA)",
    "9" = "Outlying Areas (AS, FM, GU, MH, MP, PR, PW, VI)",
    .default = NA_character_
  )

```

# Plot 1

```{r plot_1}
#| echo: false 
# Create plot 1 here
table <- scorecard |> 
  group_by(control_text) |> 
  summarize(average_students = mean(ugds, na.rm = TRUE))

ggplot(data = table, aes(x = control_text, y = average_students, fill = control_text)) +
  geom_bar(stat = "identity") +
  labs(title = "Average Number of Students by Institution Type",
       x = "Institution Type",
       y = "Average Number of Students",
       fill = "College category",
       caption = "author: Leah Levensailor \n source: College Scorecard Institution-Level Data ") +
  theme_minimal() +
  scale_fill_manual(values = c("Public" = "blue", 
                               "Private for-profit" = "red", 
                               "Private nonprofit" = "green")) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Plot 2

# Create plot 2 here
library("RColorBrewer")
#RColorBrewer::display.brewer.all()
colors = c("red", "pink", "blue")
ggplot(data = scorecard, 
       aes(x = adm_rate, 
           y = ugds, 
           color = control_text)) +
  geom_point(size = 2) +
  scale_color_brewer(palette = "Dark2") +
  scale_x_continuous(labels = scales::percent) +
  labs( 
    title="admission rate vs number of undergraduate students",
    x = "admission rate",
    y = "number of undergrads",
    color = "college category",
       caption = "author: Allison Reel \n source: College Scorecard Institution-Level Data ") +
  theme_minimal()
```

# Blog post


The data we are working with for our research and findings is the College Scorecard Institution-Level Data. This dataset provides information about institutions as a whole and also specific fields of study in the United States. This data was produced by federal reports by institutions, financial aid data, and tax data. Specifically, we are focusing on post secondary institutions in Massachusetts in 2021. Our guiding question is in Massachusetts in 2021, are private, non profit, or public schools thriving in terms of student popularity? To investigate this broad topic, we look at the data from private, non profit, and public post secondary schools data including their number of undergraduate students and their admissions rate. 

Our first plot looks at the relationship between average number of students and type of institution. The graph is split into three separate bars for each institution type: public, private non-profit, and private for-profit. We can conclude from this graph that typically the public institutions in Massachusetts have a higher number of students with an average of 3480 students per institution. The outlier is the Private For-Profit average number of students with 151 students. This number is brought down by the smaller specialized schools such as Empire Beauty School-Boston with only 87 people in the undergraduate population. The public universities in this graph donâ€™t show a great discrepancy between the public and private non-profit institutions but in reality, there is such a large gap between the largest and smallest number of students in all of the public universities. The average is brought down by all of the smaller public schools. Our second plot looks at the relationship between admissions rate and number of undergraduate students, colored by the status of private, non profit, and public institutions. From this graph, we observe that for public institutions, the vast majority have a very high admission rate but hover around an average number of undergraduate students enrolled. This implies that public colleges/universities are relatively popular, as they admit a large number of students while having an average number of undergraduates enrolled. For private institutions, they are evenly spread along the admission rate, while remaining comparable numbers of undergraduate enrollment. We conclude from this information that since these colleges and universities have a similar number of undergraduates as public institutions, but often lower admission rates, they are more popular than public institutions. 

The key takeaway from our analysis is that public institutions have larger student populations than private or nonprofit institutions, indicating a level of popularity, but have higher admission rates, indicating a possibility of less popularity in terms of applicant pool. The data collected for this dataset is those institutions that receive federal funding. The institutions collect their own data, and may have different ways of doing so, possibly leading to different reports and non-standardized data collection. This data also provides financial information in terms of the institution to families and applicants, but not the culture or surroundings of the college itself, including city or town living expenses. 


